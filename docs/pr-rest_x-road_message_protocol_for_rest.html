<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="github-markdown.css">
    <style>
      .markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }
    </style>
    <title>X-Road: 7.4.1
</title>
  </head>
  <body>
    <article class="markdown-body">
<div class="markdown-heading"><h1 class="heading-element">X-Road: Message Protocol for REST</h1><a id="x-road-message-protocol-for-rest" class="anchor" aria-label="Permalink: X-Road: Message Protocol for REST" href="#x-road-message-protocol-for-rest"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p><strong>Technical Specification</strong></p>
<p>Version: 1.0.3<br>
Doc. ID: PR-REST</p>
<hr>
<div class="markdown-heading"><h2 class="heading-element">Version history</h2><a id="version-history" class="anchor" aria-label="Permalink: Version history" href="#version-history"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<table>
<thead>
<tr>
<th align="left">Date</th>
<th align="left">Version</th>
<th align="left">Description</th>
<th align="left">Author</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">02.10.2018</td>
<td align="left">0.1.0</td>
<td align="left">Initial draft version</td>
<td align="left">Ilkka Seppälä</td>
</tr>
<tr>
<td align="left">30.10.2018</td>
<td align="left">0.2.0</td>
<td align="left"><ul>
<li>Multiple phrasing improvements</li>
<li>Protocol version format changed to 'r1' from 'v1'</li>
<li>Introduced serviceId concept</li>
<li>Image updated</li>
<li>Improved error handling</li>
<li>Introduced security section</li>
<li>Clarified REST interface section</li>
<li>Add default content-type</li>
<li>Clarified optional X-Road headers</li>
<li>Clarified error handling</li>
</ul></td>
<td align="left">Ilkka Seppälä <br> Petteri Kivimäki <br> Jarkko Hyöty</td>
</tr>
<tr>
<td align="left">11.01.2019</td>
<td align="left">0.3.0</td>
<td align="left"><ul>
<li>Remove constant prefix <code>/rest</code> from the protocol</li>
<li>Consumer ID is specified with HTTP headers instead of encoding it to the request URL</li>
<li>Clarified service id and client id encoding (percent-encoded UTF-8)</li>
<li>Changes to "Use of HTTP Headers" section <br> - Clarified user defined headers rules <br> - Added filtered headers section <br> - Added cache headers section <br> - Added cross-origin resource sharing section <br> - Clarified Content-Type header <br> - Added explanation of specially handled headers </li>
<li>Added HTTP version to "Scope and Requirements" chapter</li>
<li>Use OpenAPI 3.0 service description</li>
<li>Updated the examples according to REST guidelines</li>
<li>Added section about HTTP redirections</li>
</ul></td>
<td align="left">Ilkka Seppälä <br> Petteri Kivimäki <br> Jarkko Hyöty <br> Janne Mattila <br> Lauri Koutaniemi</td>
</tr>
<tr>
<td align="left">21.02.2019</td>
<td align="left">0.4.0</td>
<td align="left"><ul>
<li>Added chapter 1.2 containing general description about REST architectural style</li>
<li>Clarified 3.2 objectives</li>
<li>Clarified 'X-Road-UserId' header</li>
<li>Added 4.3 request hash header</li>
<li>Added 4.6 example 5 about tracking the source of error</li>
<li>Clarified 2.3 protocol versioning</li>
<li>Minor grammar changes to 4.1</li>
<li>Added a warning to 4.4 about following redirects</li>
<li>Fixed 4.6 example 2 -&gt; X-Road-Error header added</li>
<li>Clarified 4.6 user defined headers</li>
<li>Clarified 5.1 what is the role of OpenAPI 3</li>
<li>Updated the response body format in 4.6 error handling</li>
<li>Added X-Road-Security-Server header to 4.3 to make it possible to call monitoring via REST</li>
</ul></td>
<td align="left">Ilkka Seppälä <br> Petteri Kivimäki <br> Jarkko Hyöty</td>
</tr>
<tr>
<td align="left">22.03.2019</td>
<td align="left">0.5.0</td>
<td align="left"><ul>
<li>Clarified 1.1 overview</li>
<li>Clarified 3.2 objectives</li>
<li>Added to 4.3 chapter "X-Road specific headers returned in the response"</li>
<li>Clarified the use of X-Road-Id in 4.3</li>
<li>Removed chapter 5.2 where it was recommended to use [REST-BEST-PRACTISES]</li>
<li>Updated examples in chapters 4.6 and 6</li>
<li>Updated request hash description in 4.3</li>
</ul></td>
<td align="left">Ilkka Seppälä <br> Petteri Kivimäki <br> Jarkko Hyöty</td>
</tr>
<tr>
<td align="left">22.03.2019</td>
<td align="left">0.9.0</td>
<td align="left">Initial Markdown documentation</td>
<td align="left">Caro Hautamäki</td>
</tr>
<tr>
<td align="left">25.04.2019</td>
<td align="left">1.0.0</td>
<td align="left">Update document version number</td>
<td align="left">Jarkko Hyöty</td>
</tr>
<tr>
<td align="left">19.05.2020</td>
<td align="left">1.0.1</td>
<td align="left">Added chapter <a href="#48-identifier-character-restrictions">4.8 Identifier Character Restrictions</a>
</td>
<td align="left">Ilkka Seppälä</td>
</tr>
<tr>
<td align="left">27.05.2022</td>
<td align="left">1.0.2</td>
<td align="left"><ul>
<li>Added <code>X-Road-Represented-Party</code> extension header to 4.3</li>
<li>Updated <code>X-Road-Client</code> header description in 4.3</li>
</ul></td>
<td align="left">Petteri Kivimäki</td>
</tr>
<tr>
<td align="left">15.06.2023</td>
<td align="left">1.0.3</td>
<td align="left">Stricter identifier character restrictions</td>
<td align="left">Madis Loitmaa</td>
</tr>
</tbody>
</table>
<div class="markdown-heading"><h2 class="heading-element">License</h2><a id="license" class="anchor" aria-label="Permalink: License" href="#license"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>This document is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License. To view a copy of this
license, visit <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="nofollow">http://creativecommons.org/licenses/by-sa/3.0/</a></p>
<div class="markdown-heading"><h2 class="heading-element">Table of Contents</h2><a id="table-of-contents" class="anchor" aria-label="Permalink: Table of Contents" href="#table-of-contents"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>


<ul>
<li>
<a href="#1-introduction">1 Introduction</a>
<ul>
<li><a href="#11-overview">1.1 Overview</a></li>
<li><a href="#12-rest">1.2 REST</a></li>
</ul>
</li>
<li>
<a href="#2-definitions">2 Definitions</a>
<ul>
<li><a href="#21-key-words">2.1 Key Words</a></li>
<li><a href="#22-x-road-terminology">2.2 X-Road Terminology</a></li>
<li><a href="#23-versioning">2.3 Versioning</a></li>
<li><a href="#24-references">2.4 References</a></li>
</ul>
</li>
<li>
<a href="#3-scope">3 Scope</a>
<ul>
<li><a href="#31-scope-and-requirements">3.1 Scope and Requirements</a></li>
<li><a href="#32-objectives">3.2 Objectives</a></li>
</ul>
</li>
<li>
<a href="#4-message-format">4 Message Format</a>
<ul>
<li><a href="#41-rest-interface">4.1 REST Interface</a></li>
<li><a href="#42-uri-sanitation">4.2 URI Sanitation</a></li>
<li><a href="#43-use-of-http-headers">4.3 Use of HTTP Headers</a></li>
<li><a href="#44-http-redirects">4.4 HTTP Redirects</a></li>
<li><a href="#45-use-of-query-parameters">4.5 Use of Query Parameters</a></li>
<li>
<a href="#46-error-handling">4.6 Error handling</a>
<ul>
<li><a href="#example-1-category-1">Example 1 (Category 1)</a></li>
<li><a href="#example-2-category-2">Example 2 (Category 2)</a></li>
<li><a href="#example-3-category-3">Example 3 (Category 3)</a></li>
<li><a href="#example-4-category-4">Example 4 (Category 4)</a></li>
<li><a href="#example-5-tracking-the-source-of-error">Example 5 (Tracking the source of error)</a></li>
</ul>
</li>
<li><a href="#47-security">4.7 Security</a></li>
<li><a href="#48-identifier-character-restrictions">4.8 Identifier Character Restrictions</a></li>
</ul>
</li>
<li>
<a href="#5-services">5 Services</a>
<ul>
<li><a href="#51-describing-services">5.1 Describing Services</a></li>
</ul>
</li>
<li>
<a href="#6-examples">6 Examples</a>
<ul>
<li><a href="#61-general">6.1 General</a></li>
<li><a href="#62-get-request-and-response">6.2 GET Request and Response</a></li>
<li><a href="#63-put-request-and-response">6.3 PUT Request and Response</a></li>
<li><a href="#64-post-request-and-response">6.4 POST Request and Response</a></li>
<li><a href="#65-delete-request-and-response">6.5 DELETE Request and Response</a></li>
<li><a href="#66-post-request-with-attachments-and-response">6.6 POST Request with Attachments and Response</a></li>
</ul>
</li>
<li><a href="#appendix-1-example-service-definition">Appendix 1 Example Service Definition</a></li>
</ul>

<div class="markdown-heading"><h2 class="heading-element">1 Introduction</h2><a id="1-introduction" class="anchor" aria-label="Permalink: 1 Introduction" href="#1-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">1.1 Overview</h3><a id="11-overview" class="anchor" aria-label="Permalink: 1.1 Overview" href="#11-overview"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>Representational State Transfer [<a href="#Ref_RFC2119">REST</a>] is an architectural style that
defines a set of constraints to be used for creating web services. Web
services that conform to the [<a href="#Ref_RFC2119">REST</a>] architectural style, or RESTful web
services, provide interoperability between computer systems on the
Internet. REST-compliant web services allow the requesting systems to
access and manipulate representations of web resources by using a
uniform and predefined set of stateless operations. In the REST
architectural style, the client and server implementations can be
independent as long as they know the format of messages to send each
other.</p>
<p>This document describes the X-Road Message Protocol for [<a href="#Ref_RFC2119">REST</a>]. The protocol is used in X-Road
infrastructure between information systems and X-Road Security Servers to consume and produce REST
services. Between the Security Servers there is another protocol called X-Road Message Transport
Protocol which is described in its own document [<a href="#Ref_XMESSTP">PR-MESSTRANSP</a>].</p>
<p><a target="_blank" rel="noopener noreferrer" href="img/message-protocol-for-rest.png"><img src="img/message-protocol-for-rest.png" alt="" style="max-width: 100%;"></a></p>
<div class="markdown-heading"><h3 class="heading-element">1.2 REST</h3><a id="12-rest" class="anchor" aria-label="Permalink: 1.2 REST" href="#12-rest"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>In the REST architecture, clients send requests to retrieve, modify or delete resources. Servers send responses to these
requests. In general a request consists of</p>
<ul>
<li>HTTP verb, which defines the kind of operation to perform</li>
<li>header, which allows the client to pass along information about the request</li>
<li>path to a resource</li>
<li>an optional message body containing data</li>
</ul>
<p>Typically four different HTTP verbs are used to interact with the resources in REST system</p>
<ul>
<li>GET - retrieve a resource</li>
<li>POST - create new resource</li>
<li>PUT - update a resource</li>
<li>DELETE - delete a resource</li>
</ul>
<p>The most common headers used in RESTful communication are <code>Accept</code> and <code>Content-Type</code>. By including the <code>Accept</code> header
in the request the client specifies the content types it is able to read. When reading the request, the server should
respect the <code>Accept</code> header and provide the response in the specified format. The server sets the <code>Content-Type</code> header
in the response message to reveal the actual type of content.</p>
<p>The requests need to specify the path to the resource it is operating on. There are no strict rules how the paths have
to be defined, but there are commonly used recommendations. In RESTful APIs, the paths should be designed logically and
consistently so that the operations are easy to use for the client. For example a
request <code>GET https://petstore.niis.org/v2/pets/1124</code> will read a certain pet's information
and <code>POST https://petstore.niis.org/v2/pets</code> will create a new pet.</p>
<p>The response indicates the result of the operation with HTTP status code. The expected status code of success varies
depending on the requested operation.</p>
<ul>
<li>GET - 200 OK</li>
<li>POST - 201 CREATED</li>
<li>PUT - 200 OK</li>
<li>DELETE - 204 NO CONTENT</li>
</ul>
<p>Also when the operation fails, the reason is indicated with HTTP status. Some of the most common error codes are listed
below.</p>
<ul>
<li>400 BAD REQUEST</li>
<li>404 NOT FOUND</li>
<li>500 INTERNAL SERVER ERROR</li>
</ul>
<div class="markdown-heading"><h2 class="heading-element">2 Definitions</h2><a id="2-definitions" class="anchor" aria-label="Permalink: 2 Definitions" href="#2-definitions"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">2.1 Key Words</h3><a id="21-key-words" class="anchor" aria-label="Permalink: 2.1 Key Words" href="#21-key-words"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "
OPTIONAL" in this document (in uppercase, as shown) are to be interpreted as described in [<a href="#Ref_RFC2119">RFC2119</a>].</p>
<div class="markdown-heading"><h3 class="heading-element">2.2 X-Road Terminology</h3><a id="22-x-road-terminology" class="anchor" aria-label="Permalink: 2.2 X-Road Terminology" href="#22-x-road-terminology"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The X-Road specific terminology such as instance, member class, member and subsystem are described in the document
[<a href="#Ref_TERMS">XROAD-TERMS</a>].</p>
<div class="markdown-heading"><h3 class="heading-element">2.3 Versioning</h3><a id="23-versioning" class="anchor" aria-label="Permalink: 2.3 Versioning" href="#23-versioning"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The X-Road Message Protocol for REST uses [<a href="#Ref_SEMVER">SEMANTIC-VERSIONING</a>] rules. After the initial development
phase (0.x) there MUST be a strongly justified reason for amending or updating the protocol. Especially new major
versions of the protocol SHOULD be extremely rare.</p>
<p>The protocol version identifier comes from the major version of the protocol and is a mandatory part of the request URL.
The initial released version of the protocol will have the identifier r1. When the protocol needs to be updated, the
most important consideration is backwards compatibility.</p>
<p><strong>A)</strong> If the change can be introduced in a backwards compatible manner (i.e. the clients not aware of the change are
still able to communicate using the protocol) the major protocol version and the protocol version identifier remain the
same. Depending on the scope of the change, the minor or patch version is incremented e.g. 1.0.0 → 1.1.0.</p>
<p><strong>B)</strong> If the change requires breaking the backwards compatibility the major protocol version and the
protocol version identifier are incremented e.g. 1.2.3 → 2.0.0. The old protocol will be supported
for at least a year after releasing the new version.</p>
<div class="markdown-heading"><h3 class="heading-element">2.4 References</h3><a id="24-references" class="anchor" aria-label="Permalink: 2.4 References" href="#24-references"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p><a name="Ref_REST"></a>[REST] Representational state
transfer <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" rel="nofollow">https://en.wikipedia.org/wiki/Representational_state_transfer</a></p>
<p><a name="Ref_RFC2119"></a>[RFC2119] Key words to Indicate Requirement
Levels <a href="https://www.ietf.org/rfc/rfc2119.txt" rel="nofollow">https://www.ietf.org/rfc/rfc2119.txt</a></p>
<p><a name="Ref_RFC7231"></a>[RFC7231] Hypertext Transfer Protocol (HTTP/1.1): Semantics and
Content <a href="https://tools.ietf.org/html/rfc7231" rel="nofollow">https://tools.ietf.org/html/rfc7231</a></p>
<p><a name="Ref_UUID"></a>[UUID] Universally unique
identifier <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" rel="nofollow">https://en.wikipedia.org/wiki/Universally_unique_identifier</a></p>
<p><a name="Ref_RFC3986"></a>[RFC3986] Uniform Resource Identifier (URI): Generic
Syntax <a href="https://tools.ietf.org/html/rfc3986" rel="nofollow">https://tools.ietf.org/html/rfc3986</a></p>
<p><a name="Ref_PERCENTENC"></a>[PERCENT-ENCODING] Uniform Resource Identifier (URI):
Percent-Encoding <a href="https://tools.ietf.org/html/rfc3986#section-2.1" rel="nofollow">https://tools.ietf.org/html/rfc3986#section-2.1</a></p>
<p><a name="Ref_OPENAPIINIT"></a>[OPENAPI-INITIATIVE] OpenAPI Initiative <a href="https://www.openapis.org/" rel="nofollow">https://www.openapis.org/</a></p>
<p><a name="Ref_OPENAPI3"></a>[OPENAPI3] OpenAPI Specification Version
3.0.0 <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md">https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md</a></p>
<p><a name="Ref_SEMVER"></a>[SEMANTIC-VERSIONING] Semantic Versioning <a href="https://semver.org/" rel="nofollow">https://semver.org/</a></p>
<p><a name="Ref_HPPP"></a>[HPPP] Testing for HTTP Parameter pollution (
OTG-INPVAL-004) <a href="https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_(OTG-INPVAL-004)" rel="nofollow">https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_(OTG-INPVAL-004)</a></p>
<p><a name="Ref_SSRF"></a>[SSRF] Server Side Request
Forgery <a href="https://www.owasp.org/index.php/Server_Side_Request_Forgery" rel="nofollow">https://www.owasp.org/index.php/Server_Side_Request_Forgery</a></p>
<p><a name="Ref_RFC2616"></a>[RFC2616] Hypertext Transfer Protocol --
HTTP/1.1 <a href="https://tools.ietf.org/html/rfc2616.html" rel="nofollow">https://tools.ietf.org/html/rfc2616.html</a></p>
<p><a name="Ref_RFC6265"></a>[RFC6265] HTTP State Management Mechanism <a href="https://tools.ietf.org/html/rfc6265" rel="nofollow">https://tools.ietf.org/html/rfc6265</a></p>
<p><a name="Ref_HTTPHEADERS"></a>[LIST-OF-HTTP-HEADERS] List of HTTP header
fields <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields" rel="nofollow">https://en.wikipedia.org/wiki/List_of_HTTP_header_fields</a></p>
<p><a name="Ref_XMESSTP"></a>[PR-MESSTRANSP] X-Road: Message Transport
Protocol <a href="pr-messtransp_x-road_message_transport_protocol.html">PR-MESSTRANSP</a></p>
<p><a name="Ref_TERMS"></a>[XROAD-TERMS] X-Road Terms and
Abbreviations <a href="terms_x-road_docs.html">TA-TERMS</a></p>
<div class="markdown-heading"><h2 class="heading-element">3 Scope</h2><a id="3-scope" class="anchor" aria-label="Permalink: 3 Scope" href="#3-scope"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">3.1 Scope and Requirements</h3><a id="31-scope-and-requirements" class="anchor" aria-label="Permalink: 3.1 Scope and Requirements" href="#31-scope-and-requirements"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ul>
<li>X-Road SHALL support both SOAP and REST protocols side by side. This document describes only the X-Road Message
Protocol for REST. The X-Road Message Protocol for SOAP and the X-Road Message Transport Protocol are described in
other documents.</li>
<li>Only synchronous request-response messages SHALL be supported. Asynchronous or one-way operations SHALL NOT be
possible.</li>
<li>Any payload type over REST SHALL be supported. The payload MUST NOT be restricted to just JSON or XML.</li>
<li>The protocol SHALL support any message size. In practice the message size is limited by the Security Server's memory
and disk sizes. For security reasons it is RECOMMENDED to introduce a configurable "maximum message size" parameter in
the Security Server implementation.</li>
<li>HTTP/1.1 SHALL be supported.</li>
</ul>
<div class="markdown-heading"><h3 class="heading-element">3.2 Objectives</h3><a id="32-objectives" class="anchor" aria-label="Permalink: 3.2 Objectives" href="#32-objectives"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ul>
<li>The objective of the draft versions (0.x) of the protocol is to develop it openly and utilize a process to receive and
integrate feedback from the community.</li>
<li>The objective of the protocol version 1.x is to is to be future proof so that no protocol level changes are required
for X-Road version 7.</li>
<li>The protocol must have a versioning mechanism, so that new protocol versions can be published when necessary and
multiple versions can work in parallel.</li>
</ul>
<div class="markdown-heading"><h2 class="heading-element">4 Message Format</h2><a id="4-message-format" class="anchor" aria-label="Permalink: 4 Message Format" href="#4-message-format"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">4.1 REST Interface</h3><a id="41-rest-interface" class="anchor" aria-label="Permalink: 4.1 REST Interface" href="#41-rest-interface"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>HTTP version 1.1 is used by the protocol as described in [<a href="#Ref_RFC2616">RFC2616</a>]. The consumer member/subsystem is
specified using HTTP headers. The service to be called is encoded as part of the HTTP/HTTPS request URL. Here is the
generic form of the REST service call.</p>
<p><strong>Request format</strong></p>
<div class="highlight highlight-source-httpspec"><pre>{<span class="pl-ii">http-request-method</span>} <span class="pl-ii">/{protocol-version}/{serviceId}[/path][?query-parameters]</span></pre></div>
<p><strong>HTTP request headers</strong></p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Client:</span> {client}</span></pre></div>
<ul>
<li>
<strong>{http-request-method}</strong> can be one of the request methods defined in [<a href="#Ref_RFC7231">RFC7231</a>]. For example <code>GET</code>
, <code>POST</code>, <code>PUT</code> and <code>DELETE</code>.</li>
<li>
<strong>{protocol-version}</strong>: specifies the major version of the X-Road Message Protocol for REST. For the initial
version <code>r1</code> MUST be used.</li>
<li>
<strong>{client}</strong>: specifies the member/subsystem that is used as a service client - an entity that initiates the service
call. The identifier consists of the following
parts: <code>[X-Road instance]/[member class]/[member code]/[subsystem code]</code>. Including the subsystem code is OPTIONAL.</li>
<li>
<strong>{serviceId}</strong> identifies the service that is registered under {provider-subsystem} and invoked by the request.
{serviceId} contains the following parts:
<ul>
<li>
<code>[X-Road instance]/[member class]/[member code]/[subsystem code]/[service code]</code>. Including the subsystem code is
OPTIONAL.</li>
<li>The <strong>{serviceId}</strong> is mapped to an actual service URL by the Security Server (see the example below).</li>
</ul>
</li>
<li>
<strong>[path]</strong> contains the relative path to the service to be called</li>
<li>
<strong>[query-parameters]</strong> contains the query parameters to be sent to the service</li>
</ul>
<p>Here is a practical example of an X-Road REST call.</p>
<p><strong>Request example</strong></p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-k">GET</span><span class="pl-c1"> /r1/INSTANCE/CLASS2/MEMBER2/SUBSYSTEM2/BARSERVICE/v1/bar/zyggy?quu=1</span></pre></div>
<p><strong>HTTP request headers</strong></p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Client:</span> INSTANCE/CLASS1/MEMBER1/SUBSYSTEM1</span></pre></div>
<p>Breakdown of the request URI:</p>
<ul>
<li>
<strong>{http-request-method}</strong>: <code>GET</code>
</li>
<li>
<strong>{protocol-version}</strong>: <code>/r1</code>
</li>
<li>
<strong>{client}</strong>: <code>INSTANCE/CLASS1/MEMBER1/SUBSYSTEM1</code>
</li>
<li>
<strong>{serviceId}</strong>: <code>/INSTANCE/CLASS2/MEMBER2/SUBSYSTEM2/BARSERVICE</code>
</li>
<li>
<strong>[path]</strong>: <code>/v1/bar/zyggy</code>
</li>
<li>
<strong>[query-parameters]</strong>: <code>?quu=1</code>
</li>
</ul>
<p>Assuming that the serviceId maps to the URL <a href="https://barservice.example.org/" rel="nofollow">https://barservice.example.org/</a>, the provider will see the
request <code>GET https://barservice.example.org/v1/bar/zyggy?quu=1</code>. The reason for naming the service independently of the
path is that the same provider could have a fooservice as well (<a href="https://fooservice.example.org/" rel="nofollow">https://fooservice.example.org/</a>), in which case it would
be difficult to tell the services apart if the path was the service Id (both services could have paths like "/v1/...")
unless the fooservice was attached to a separate subsystem.</p>
<div class="markdown-heading"><h3 class="heading-element">4.2 URI Sanitation</h3><a id="42-uri-sanitation" class="anchor" aria-label="Permalink: 4.2 URI Sanitation" href="#42-uri-sanitation"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The REST URIs are composed of different parts (e.g. INSTANCE/CLASS/MEMBER/SUBSYSTEM) and some of them may contain
characters that can not be used in URIs directly. The URI syntax is described in [<a href="#Ref_RFC3986">RFC3986</a>]. Because of
this the consumer information system needs to represent the parts using UTF-8 and encode the parts separately using
[<a href="#Ref_PERCENTENC">PERCENT-ENCODING</a>]. The path separator "/" is used to delimit the parts and must not be encoded,
unless the part actually contains the character "/" (not recommended).</p>
<p><strong>Examples</strong></p>
<p>Invalid:</p>
<pre><code>INSTANCE%2FCLASS%2FMEMBER%2FSUBSYSTEM%2FBARSERVICE
</code></pre>
<p>Valid:</p>
<pre><code>INSTANCE/CLASS/MEMBER/SUBSYSTEM/BAR%2FSERVICE  (where the service code is "BAR/SERVICE")
</code></pre>
<p>On the Security Server side the incoming request URIs MUST be strictly validated. Input strings from the user can't be
trusted. Lengths of the strings need to be checked and maximum length or the request URI needs to be limited. Although
the URI standard does not specify a maximum size of the URL, most clients enforce an arbitrary limit of 2000 characters.
The Security Server implementation MAY do this as well. Sending data that is difficult to express in a hierarchical
manner, and especially data that is larger than this 2000 character limit, should be transmitted in the body of the
request.</p>
<p>The REST URI parsing scenario is particularly vulnerable to [<a href="#Ref_HPPP">HPPP</a>] (HTTP Parameter Pollution) and
[<a href="#Ref_SSRF">SSRF</a>] (Server-Side Request Forgery) attacks. The Security Server SHOULD explicitly be prepared for them.</p>
<div class="markdown-heading"><h3 class="heading-element">4.3 Use of HTTP Headers</h3><a id="43-use-of-http-headers" class="anchor" aria-label="Permalink: 4.3 Use of HTTP Headers" href="#43-use-of-http-headers"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>There is only one mandatory HTTP header in the protocol that needs to be set by the client. Otherwise the use of headers
in X-Road REST service calls is OPTIONAL. The mandatory header and the most common optional header types and their
operation are described next.</p>
<p>Note. HTTP headers are not case-sensitive. <code>X-Road-Client</code> and <code>x-road-client</code> are both valid header names.</p>
<p><strong>Mandatory X-Road headers in the request</strong></p>
<ul>
<li>
<strong>X-Road-Client</strong>: Specifies the member/subsystem that is used as a service client - an entity that initiates the
service call. The identifier consists of the following
parts: <code>[X-Road instance]/[member class]/[member code]/[subsystem code]</code>. Including the subsystem code is OPTIONAL.
The identifier parts MUST be represented as UTF-8 and encoded using [<a href="#Ref_PERCENTENC">PERCENT-ENCODING</a>].
<ul>
<li>The service client MUST NOT generate multiple <code>X-Road-Client</code> headers in the request. If multiple <code>X-Road-Client</code>
headers are present in the request, the Security Server SHOULD use the last defined header as the initiator of the
service call.</li>
</ul>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Client:</span> INSTANCE/CLASS/MEMBER/SUBSYSTEM</span></pre></div>
</li>
</ul>
<p><strong>X-Road specific headers returned in the response</strong></p>
<p>The response contains some X-Road specific headers that are set by the provider Security Server. The provider service
SHOULD NOT set these headers since in that case they will be overwritten.</p>
<ul>
<li>
<strong>X-Road-Client</strong>:  Specifies the member/subsystem that is used as a service client</li>
<li>
<strong>X-Road-Service</strong>:  Specifies the serviceId that is invoked by the service client</li>
<li>
<strong>X-Road-Id</strong>: Unique identifier for this message</li>
<li>
<strong>X-Road-Request-Hash</strong>: For responses, this field contains sha-512 encoded hash of the request message</li>
<li>
<strong>X-Road-Error</strong>: This header is provided in case there was an error processing the request and it occurred somewhere
in X-Road (on the consumer or provider Security Server)</li>
<li>
<strong>X-Road-Request-Id</strong>: Unique identifier for the request
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Client:</span> INSTANCE/CLASS/MEMBER/SUBSYSTEM</span>
<span class="pl-s"><span class="pl-v">X-Road-Service:</span> INSTANCE/CLASS/MEMBER/SUBSYSTEM/PETSTORE</span>
<span class="pl-s"><span class="pl-v">X-Road-Id:</span> fa2e18a5-c2cb-4d09-b994-f57727f7c3fb</span>
<span class="pl-s"><span class="pl-v">X-Road-Request-Hash:</span> 4c519cf0-0e5e-4ccf-b72b-8ed6fe289e6e</span>
<span class="pl-s"><span class="pl-v">X-Road-Request-Id:</span> f92591a3-6bf0-49b1-987b-0dd78c034cc3</span></pre></div>
</li>
</ul>
<p><strong>Request hash header</strong></p>
<ul>
<li>
<strong>X-Road-Request-Hash</strong>: For responses, this field SHALL contain the base-64 encoded SHA512(SHA512(headers)+SHA512(
body)). If there is no body, then only the headers are included in the calculation i.e. the field contains the base-64
encoded SHA512(headers). This field is automatically filled in by the service provider's Security Server. The field is
used to create a strong connection between a request and a response. Thus, it is possible to prove, for example, that
a certain registry record is returned in response to a certain query.</li>
<li>The request hash header MUST be automatically created by the service provider's Security Server
and it MUST be verified by the service client's Security Server</li>
<li>The request message SHOULD NOT contain the request hash header.</li>
<li>The response message returned by a service provider SHOULD NOT contain the request hash header. If the response
message contains the request hash header, the service provider's Security Server MUST ignore the field and replace it
with the created field.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Request-Hash:</span> 14sEri8SmLNy/DJyTob0ZddAskmdRy5ZUyhbr33iLkaA+gLpWcivUH16fzbuIs7hhs2AnA4lJDloyIihXMlVQA== </span></pre></div>
</li>
</ul>
<p><strong>Content-Type header</strong></p>
<ul>
<li>With REST messages that include the request body it is RECOMMENDED that the content's media type is indicated with
this header. Additionally it is RECOMMENDED to use the charset parameter to indicate the character encoding used the
REST message.</li>
<li>The REST messages originating from the Security Server (e.g. error messages) MUST include the header and indicate the
content's type and character encoding with it.</li>
<li>If Content-Type header is included in the request message by the consumer information system, it MUST be transported
unmodified through X-Road to the provider information system</li>
<li>If Content-Type header is included in the response message by the provider information system, it MUST be transported
unmodified through X-Road to the consumer information system
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Content-Type:</span> application/json; charset=utf-8</span>
<span class="pl-s"><span class="pl-v">Content-Type:</span> multipart/form-data; boundary=something</span></pre></div>
</li>
</ul>
<p>In case the service consumer does not provide the <code>Content-Type</code> header (or some of its components), the request message
is anyhow passed to the provider service which can decide what to do with it.</p>
<p><strong>Accept header</strong></p>
<ul>
<li>It is RECOMMENDED that the service consumer advertises the content types it is able to understand by including
the <code>Accept</code> header in the request message.</li>
<li>If <code>Accept</code> header is included in the request message, it MUST be transported unmodified through X-Road to the service
provider.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Accept:</span> application/xml</span></pre></div>
</li>
</ul>
<p>In case the service consumer does not provide the Accept header, the Security Server MUST use the default
content-type <code>application/json</code>.</p>
<p><strong>Security Server, Represented Party and X-Road extension headers</strong></p>
<ul>
<li>
<strong>X-Road-Security-Server</strong>: To send the request to a specific Security Server this header needs to be included. It
contains the following parts:
<ul>
<li><code>[X-Road instance]/[member class]/[member code]/[server code]</code></li>
</ul>
</li>
<li>
<strong>X-Road-Represented-Party</strong>: The purpose of this header is to allow sending of additional information to the X-Road
service providers in case when service client represents third party while issuing a query. The query is initiated by
a third party and the results are also forwarded to that third party, but the request itself is signed by a client
identified by the <code>X-Road-Client</code> header. It contains the following parts:
<ul>
<li><code>[member class]/[member code]</code></li>
<li>Including the member class is OPTIONAL. If the member class is omitted, also the separator <code>/</code> must be omitted:
<ul>
<li><code>[member code]</code></li>
</ul>
</li>
</ul>
</li>
<li>Other X-Road extension headers are not defined in this document. Rather they are just contracts between information
systems and X-Road handles them like any user defined header.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Security-Server:</span> INSTANCE/MEMBERCLASS/MEMBERCODE/SERVERCODE</span>
<span class="pl-s"><span class="pl-v">X-Road-Represented-Party:</span> MEMBERCLASS/MEMBERCODE</span></pre></div>
</li>
</ul>
<p><strong>Optional X-Road headers</strong></p>
<ul>
<li>
<strong>X-Road-Id</strong>: Unique identifier for this message. It is RECOMMENDED to use universally unique identifiers
[<a href="#Ref_UUID">UUID</a>]. If <code>X-Road-Id</code> is not provided, it SHALL be generated by the consumer Security Server. The
provider Security Server SHALL include the <code>X-Road-Id</code> header in the response message.</li>
<li>
<strong>X-Road-UserId</strong>: User whose action initiated the request. The user ID should be prefixed with two-letter ISO country
code (e.g., EE12345678901).</li>
<li>
<strong>X-Road-Issue</strong>: Identifies received application, issue or document that was the cause of the service request. This
field may be used by the client information system to connect service requests (and responses) to working procedures.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Road-Id:</span> fa2e18a5-c2cb-4d09-b994-f57727f7c3fb</span>
<span class="pl-s"><span class="pl-v">X-Road-UserId:</span> EE12345678901</span>
<span class="pl-s"><span class="pl-v">X-Road-Issue:</span> MT324223MSD</span></pre></div>
</li>
</ul>
<p><strong>X-Road error header</strong></p>
<ul>
<li>X-Road-Error: This header is provided in case there was an error processing the request and it occurred somewhere in
X-Road (on the consumer or provider Security Server). With it the client can easily distinguish between the errors
occurring on provider services and errors on X-Road Security Servers. Note that the header does not contain detailed
error information but is more like a flag indicator to the interested parties. The header contains only the error type
and the more detailed information such as the HTTP response code, error message body etc. need to be read from the
response body.
<pre><code>Server.ServerProxy.DatabaseError
</code></pre>
</li>
</ul>
<p><strong>User defined headers</strong></p>
<ul>
<li>User defined HTTP headers (i.e. the headers not mentioned in [<a href="#Ref_HTTPHEADERS">LIST-OF-HTTP-HEADERS</a>] or this
document) MUST be passed to recipient unmodified by X-Road Security Server.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">X-Powered-By:</span> PHP/5.2.17</span>
<span class="pl-s"><span class="pl-v">X-Pingback:</span> https://example.com/xmlrpc.php</span></pre></div>
</li>
</ul>
<p><strong>Cache headers</strong></p>
<ul>
<li>X-Road does not cache messages. Cache headers MUST be passed as-is and the consumer/provider MAY take advantage of
this information.
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Cache-Control:</span> no-cache, no-store, must-revalidate</span>
<span class="pl-s"><span class="pl-v">Pragma:</span> no-cache</span></pre></div>
</li>
</ul>
<p><strong>Cross-origin resource sharing</strong></p>
<ul>
<li>Security Server is not designed to be a direct proxy for a web front-end. It does not do anything specific to enable
cross-origin resource sharing (CORS).</li>
</ul>
<p><strong>Filtered headers</strong></p>
<p>Some HTTP headers MUST be rewritten by the Security Server. The original value, if any, will not be passed through. The
Security Server will either provide a new value or not send the header at all.</p>
<ul>
<li>Hop-by-hop headers
<ul>
<li>Connection, Keep-Alive, Proxy-Authenticate, Proxy-Authorization, TE, Trailer, Transfer-Encoding, Upgrade</li>
</ul>
</li>
<li>Headers that can leak the name or address of the origin host
<ul>
<li>Host</li>
<li>User-Agent</li>
<li>Server</li>
</ul>
</li>
</ul>
<p><strong>Specially handled headers</strong></p>
<p>Some HTTP headers are handled by the Security Server and the user should not expect that they are passed through X-Road
unmodified.</p>
<ul>
<li>Expect
<ul>
<li>Expectation <code>100 Continue</code>  MAY be handled locally at the consumer Security Server. Support for other expectations
is OPTIONAL.</li>
<li>(<code>100 Continue</code> is the only expectation defined by [<a href="#Ref_RFC7231">RFC7231</a>])</li>
</ul>
</li>
<li>Content-Length
<ul>
<li>The Security Server MAY change the transfer encoding, thus removing or adding a content-length header as
necessary.</li>
</ul>
</li>
</ul>
<div class="markdown-heading"><h3 class="heading-element">4.4 HTTP Redirects</h3><a id="44-http-redirects" class="anchor" aria-label="Permalink: 4.4 HTTP Redirects" href="#44-http-redirects"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The service provider may respond with HTTP redirection. HTTP redirects are responses with a status code of 3xx. There
are several types of redirects and they fall into three categories: permanent, temporary and special redirections.
X-Road does not follow redirects and passes the redirection unmodified to the service consumer. The service consumer may
decide what to do with this response. Generally speaking, the redirects pose a security threat and should not be blindly
followed. The default setting for following redirects is recommended to be off.</p>
<div class="markdown-heading"><h3 class="heading-element">4.5 Use of Query Parameters</h3><a id="45-use-of-query-parameters" class="anchor" aria-label="Permalink: 4.5 Use of Query Parameters" href="#45-use-of-query-parameters"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The use of query parameters in the X-Road REST service calls is supported. The query parameters need be encoded
[<a href="#Ref_PERCENTENC">PERCENT-ENCODING</a>] by the consumer information system as described in [<a href="#Ref_RFC3986">RFC3986</a>].
The query parameters MUST be passed unmodified through the X-Road Security Servers to the provider service.</p>
<div class="markdown-heading"><h3 class="heading-element">4.6 Error handling</h3><a id="46-error-handling" class="anchor" aria-label="Permalink: 4.6 Error handling" href="#46-error-handling"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>In a normal situation the request reaches the provider service and it returns the response back to the consumer
information system. However, the Security Server may encounter technical errors and in these cases it must respond in a
predictable manner. When a technical error occurs, the Security Server MUST use HTTP status codes as defined in
[<a href="#Ref_RFC7231">RFC7231</a>] to communicate it back to the consumer information system.</p>
<p>[<a href="#Ref_RFC7231">RFC7231</a>] defines over 70 HTTP status codes. Most of the developers do not have them memorized so they
have to go to the Internet and look them up. To make it simpler for the developers the X-Road Message Protocol for REST
uses only a small subset of HTTP status codes.</p>
<p>When it is boiled down, there are really 4 categories of errors between the client and the Security Server.</p>
<ol>
<li>Everything worked in the Security Server's perspective but the provider information system returns an error response.</li>
<li>The provider information system encounters a technical error and is not able to return a response.</li>
<li>The consumer information system sends a request that does not comply with the X-Road Message Protocol for REST.</li>
<li>The Security Server encounters a technical error.</li>
</ol>
<p>We map these categories to the HTTP status codes and response bodies.</p>
<ol>
<li>The status code, response body and HTTP headers are generated by the provider information system and they are
returned as-is.</li>
<li>500 - The status code, response body and HTTP headers are returned by the Security Server.</li>
<li>400 - Bad Request. The status code, response body and HTTP headers are returned by the Security Server.</li>
<li>500 - Internal Server Error. The status code, response body and HTTP headers are returned by the Security Server.</li>
</ol>
<p>Using only the HTTP status codes it is impossible to know if the error occurred on X-Road Security Servers or on the
provider service. The <code>type</code> field in the response body gives some tools since the X-Road errors start with <code>Client</code> (
consumer service), <code>Server.ClientProxy</code> (consumer Security Server) or <code>Server.ServerProxy</code> (provider Security Server).
To make it easier to distinguish between the errors coming from the X-Road Security Server and the provider service, the
Security Server MUST add an additional HTTP header to the response when the error occurs on the Security Server.
The <code>X-Road-Error</code> header is specified in chapter <a href="#43-use-of-http-headers">4.3</a>.</p>
<p>When the error occurs on the Security Server, the Security Server implementation SHOULD respect the <code>Accept</code> header
specified by the consumer information system and return the X-Road error response using the suggested content type,
defaulting to <code>application/json</code>. Additionally, the Security Server MUST include <code>Content-Type</code> header in the response
to indicate the media type of the response.</p>
<div class="markdown-heading"><h4 class="heading-element">Example 1 (Category 1)</h4><a id="example-1-category-1" class="anchor" aria-label="Permalink: Example 1 (Category 1)" href="#example-1-category-1"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>Everything worked in the Security Server's perspective, but the service returned an error. Status code, response body
and HTTP headers are generated by the provider information system and they are returned as-is.</p>
<p>HTTP status code:</p>
<pre><code>405
</code></pre>
<p>Response body:</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"timestamp"</span>: <span class="pl-s"><span class="pl-pds">"</span>2019-03-21T09:45:19.904Z<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"status"</span>: <span class="pl-c1">405</span>,
  <span class="pl-ent">"error"</span>: <span class="pl-s"><span class="pl-pds">"</span>Method Not Allowed<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"message"</span>: <span class="pl-s"><span class="pl-pds">"</span>Request method 'PUT' not supported<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"path"</span>: <span class="pl-s"><span class="pl-pds">"</span>/v3/pet/findByStatus<span class="pl-pds">"</span></span>
}</pre></div>
<p>HTTP headers:</p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Content-Type:</span> application/json;charset=utf-8</span>
<span class="pl-s"><span class="pl-v">Date:</span> Thu, 21 Mar 2019 09:45:19 GMT</span>
<span class="pl-s"><span class="pl-v">x-road-id:</span> 5ea48ae9-15c1-465a-be15-9b6ef2c7ef4a</span>
<span class="pl-s"><span class="pl-v">x-road-client:</span> DEV/COM/222/TESTCLIENT</span>
<span class="pl-s"><span class="pl-v">x-road-service:</span> DEV/COM/222/TESTSERVICE/petstore</span>
<span class="pl-s"><span class="pl-v">x-road-request-id:</span> f92591a3-6bf0-49b1-987b-0dd78c034cc3</span>
<span class="pl-s"><span class="pl-v">x-road-request-hash:</span> yFOLGuJ0zmLhZSgwp3ooSBQbR9ejSvTc6p6FvBmcSEB2tDD6bxpjiv8sHORxqz4MMgEADH7IcARNprLfEwudNw==</span>
<span class="pl-s"><span class="pl-v">Content-Length:</span> 159</span></pre></div>
<div class="markdown-heading"><h4 class="heading-element">Example 2 (Category 2)</h4><a id="example-2-category-2" class="anchor" aria-label="Permalink: Example 2 (Category 2)" href="#example-2-category-2"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>Everything worked in the Security Server's perspective, but the service timed out. The status code, response body and
HTTP headers are returned by the Security Server.</p>
<p>HTTP status code:</p>
<pre><code>500
</code></pre>
<p>Response body:</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>Server.ServerProxy.NetworkError<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"message"</span>: <span class="pl-s"><span class="pl-pds">"</span>Connect to 10.139.178.1:8080 [/10.139.178.1] failed: Connection timed out (Connection timed out)<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"detail"</span>: <span class="pl-s"><span class="pl-pds">"</span>9bc95b6e-2f1d-4a41-a7e6-11eda7d734d5<span class="pl-pds">"</span></span>
}</pre></div>
<p>HTTP headers:</p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Date:</span> Thu, 21 Mar 2019 11:42:03 GMT</span>
<span class="pl-s"><span class="pl-v">Content-Type:</span> application/json;charset=utf-8</span>
<span class="pl-s"><span class="pl-v">X-Road-Error:</span> Server.ServerProxy.NetworkError</span>
<span class="pl-s"><span class="pl-v">Content-Length:</span> 199</span></pre></div>
<div class="markdown-heading"><h4 class="heading-element">Example 3 (Category 3)</h4><a id="example-3-category-3" class="anchor" aria-label="Permalink: Example 3 (Category 3)" href="#example-3-category-3"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The consumer information system sends a request that doesn't conform to the X-Road Message Protocol for REST. The status
code, response body and HTTP headers are returned by the Security Server.</p>
<p>HTTP status code:</p>
<pre><code>400
</code></pre>
<p>Response body:</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>Client.BadRequest<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"message"</span>: <span class="pl-s"><span class="pl-pds">"</span>Error parsing the client's REST request. Please that the request format corresponds to the X-Road Message Protocol for REST (r1).<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"detail"</span>: <span class="pl-s"><span class="pl-pds">"</span>018cbcae-537e-421b-b6f6-2608dc97bd90<span class="pl-pds">"</span></span>
}</pre></div>
<p>HTTP headers:</p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Date:</span> Thu, 21 Mar 2019 11:45:12 GMT</span>
<span class="pl-s"><span class="pl-v">Content-Type:</span> application/json;charset=utf-8</span>
<span class="pl-s"><span class="pl-v">X-Road-Error:</span> Client.BadRequest</span>
<span class="pl-s"><span class="pl-v">Content-Length:</span> 167</span></pre></div>
<div class="markdown-heading"><h4 class="heading-element">Example 4 (Category 4)</h4><a id="example-4-category-4" class="anchor" aria-label="Permalink: Example 4 (Category 4)" href="#example-4-category-4"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>Error occurred on the provider Security Server. The status code, response body and HTTP headers are returned by the
Security Server.</p>
<p>HTTP status code:</p>
<pre><code>500
</code></pre>
<p>Response body:</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>Server.ServerProxy.DatabaseError<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"message"</span>: <span class="pl-s"><span class="pl-pds">"</span>Error accessing database (serverconf)<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"detail"</span>: <span class="pl-s"><span class="pl-pds">"</span>3c4d0f08-440f-417f-b935-bc801e103d51<span class="pl-pds">"</span></span>
}</pre></div>
<p>HTTP headers:</p>
<div class="highlight highlight-source-httpspec"><pre><span class="pl-s"><span class="pl-v">Date:</span> Thu, 21 Mar 2019 11:57:11 GMT</span>
<span class="pl-s"><span class="pl-v">Content-Type:</span> application/json;charset=utf-8</span>
<span class="pl-s"><span class="pl-v">X-Road-Error:</span> Server.ServerProxy.DatabaseError</span>
<span class="pl-s"><span class="pl-v">Content-Length:</span> 141</span></pre></div>
<div class="markdown-heading"><h4 class="heading-element">Example 5 (Tracking the source of error)</h4><a id="example-5-tracking-the-source-of-error" class="anchor" aria-label="Permalink: Example 5 (Tracking the source of error)" href="#example-5-tracking-the-source-of-error"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>When an error occurs it is important to be able to track the component that is causing the error. One of the most
confusing error responses can be HTTP 500 Internal Error.</p>
<p>HTTP 500 can come from the service provider or from the Security Servers.</p>
<p><strong>A)</strong> If the response does not contain the <code>X-Road-Error</code> header, the source of the error is the provider information
system.</p>
<p><strong>B)</strong> If the response contains the <code>X-Road-Error</code> header the source of the error is X-Road and the more specific
component can be deduced from the <code>type</code> field in the response body. For example <code>Server.ServerProxy.ServiceFailed</code>
means that the provider Security Server did not get answer from the provider service. <code>Server.ServerProxy.DatabaseError</code>
means that provider Security Server encountered internal error. <code>Server.ClientProxy.OutdatedGlobalConf</code> points to
consumer Security Server's problem.</p>
<div class="markdown-heading"><h3 class="heading-element">4.7 Security</h3><a id="47-security" class="anchor" aria-label="Permalink: 4.7 Security" href="#47-security"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>Secure REST services should only provide HTTPS endpoints. This concerns both the consumer Security Server and the
provider service. HTTPS protects authentication credentials in transit, for example passwords, API keys or JSON Web
Tokens. It also allows clients to authenticate the service and guarantees integrity of the transmitted data.</p>
<p>It is RECOMMENDED to use mutually authenticated client-side certificates in the connections between the Security Server
and information systems - both service consumers and service providers, to provide additional protection for highly
privileged web services. Security Server MUST support mutually authenticated client-side certificates on both consumer
and provider side. Use of JWT tokens as an authentication method between the Security Server and information system is
not supported. Instead, sending JWT tokens in HTTP headers from the service consumer to the service provider is
supported - X-Road passes the headers unmodified.</p>
<div class="markdown-heading"><h3 class="heading-element">4.8 Identifier Character Restrictions</h3><a id="48-identifier-character-restrictions" class="anchor" aria-label="Permalink: 4.8 Identifier Character Restrictions" href="#48-identifier-character-restrictions"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>X-Road identifiers include, but are not restricted to:</p>
<ul>
<li>Instance id</li>
<li>Member class</li>
<li>Member code</li>
<li>Subsystem code</li>
<li>Service code</li>
<li>Service version</li>
<li>Security server code</li>
</ul>
<p>X-Road Message Protocol for REST imposes some restrictions on the characters that can be used in X-Road identifiers.
Only the following characters MUST be used in the identifier values:</p>
<ul>
<li>Letters <code>A...Z</code> and <code>a...z</code>
</li>
<li>Numbers <code>0...9</code>
</li>
<li>Symbols <code>'()+,-.=?</code>
</li>
</ul>
<div class="markdown-heading"><h2 class="heading-element">5 Services</h2><a id="5-services" class="anchor" aria-label="Permalink: 5 Services" href="#5-services"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">5.1 Describing Services</h3><a id="51-describing-services" class="anchor" aria-label="Permalink: 5.1 Describing Services" href="#51-describing-services"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The REST services that are going to be connected to Security Server SHOULD be described with [<a href="#Ref_OPENAPI3">OPENAPI3</a>
]. It is a specification for machine-readable interface files for describing, producing, consuming, and visualizing
RESTful web services. The OpenAPI Specification is a community-driven open specification within the
[<a href="#Ref_OPENAPIINIT">OPENAPI-INITIATIVE</a>], a Linux Foundation Collaborative Project.</p>
<p>An example [<a href="#Ref_OPENAPI3">OPENAPI3</a>] service definition file is listed
in <a href="#appendix-1-example-service-definition">Appendix 1</a>. This service is used in the examples of the next chapter.</p>
<div class="markdown-heading"><h2 class="heading-element">6 Examples</h2><a id="6-examples" class="anchor" aria-label="Permalink: 6 Examples" href="#6-examples"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="markdown-heading"><h3 class="heading-element">6.1 General</h3><a id="61-general" class="anchor" aria-label="Permalink: 6.1 General" href="#61-general"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The pet store service used in the following examples has an [<a href="#Ref_OPENAPI3">OPENAPI3</a>] service description file
available in <a href="#appendix-1-example-service-definition">Appendix 1</a>. The most important aspects of the service are
described in the text but for more details please refer to the aforementioned service description file.</p>
<p>The examples assume that the <code>serviceId</code> is mapped to <a href="https://petstore.niis.org/" rel="nofollow">https://petstore.niis.org/</a>.</p>
<div class="markdown-heading"><h3 class="heading-element">6.2 GET Request and Response</h3><a id="62-get-request-and-response" class="anchor" aria-label="Permalink: 6.2 GET Request and Response" href="#62-get-request-and-response"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>REQUEST</p>
<table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Method</th>
<th align="left">Description</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/pets/{petId}</td>
<td align="left">GET</td>
<td align="left">Finds pet by ID</td>
<td align="left">petId - ID of pet to return</td>
</tr>
</tbody>
</table>
<p>Service called directly</p>
<div class="highlight highlight-source-shell"><pre>curl -X GET <span class="pl-s"><span class="pl-pds">"</span>https://petstore.niis.org/v2/pets/1124<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span></pre></div>
<p>Service called through X-Road</p>
<div class="highlight highlight-source-shell"><pre>curl -X GET <span class="pl-s"><span class="pl-pds">"</span>https://{securityserver}/r1/{serviceId}/v2/pets/1124<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>X-Road-Client: {client}<span class="pl-pds">"</span></span></pre></div>
<p>Service response</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"id"</span>: <span class="pl-c1">1124</span>,
  <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>Siddu<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"photoUrls"</span>: [],
  <span class="pl-ent">"tags"</span>: [],
  <span class="pl-ent">"status"</span>: <span class="pl-s"><span class="pl-pds">"</span>Offline<span class="pl-pds">"</span></span>
}</pre></div>
<p>Service response code</p>
<pre><code>200
</code></pre>
<p>Service response headers</p>
<pre><code>Content-Type: application/json;charset=utf-8
Date: Thu, 21 Mar 2019 12:36:39 GMT
x-road-id: 29f4d011-ef17-4f2f-9bb1-0452ce17d3f5
x-road-client: DEV/COM/222/TESTCLIENT
x-road-service: DEV/COM/222/TESTSERVICE/petstore
x-road-request-id: f92591a3-6bf0-49b1-987b-0dd78c034cc3
x-road-request-hash: Xvx9V2U5c5RhDUiXpVLtW7L8vTd5cM2IOBU2n9efEk7/m3ECKyGAp7yTpJpTWpo6HcmwSaGO+cinxMVKjxJTOQ==
Content-Length: 1148
</code></pre>
<div class="markdown-heading"><h3 class="heading-element">6.3 PUT Request and Response</h3><a id="63-put-request-and-response" class="anchor" aria-label="Permalink: 6.3 PUT Request and Response" href="#63-put-request-and-response"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>REQUEST</p>
<table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Method</th>
<th align="left">Description</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/pets/{petId}</td>
<td align="left">PUT</td>
<td align="left">Update an existing pet</td>
<td align="left">body - Pet object that will be updated in the store</td>
</tr>
</tbody>
</table>
<p>Service called directly</p>
<div class="highlight highlight-source-shell"><pre>curl -X PUT <span class="pl-s"><span class="pl-pds">"</span>https://petstore.niis.org/v2/pets/5657082955040009<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: application/json<span class="pl-pds">"</span></span> -d <span class="pl-s"><span class="pl-pds">'</span>{ "id": 0, "category": { "id": 0, "name": "string" }, "name": "doggie", "photoUrls": [ "string" ], "tags": [ { "id": 0, "name": "string" } ], "status": "available"}<span class="pl-pds">'</span></span></pre></div>
<p>Service called through X-Road</p>
<div class="highlight highlight-source-shell"><pre>curl -X PUT <span class="pl-s"><span class="pl-pds">"</span>https://{securityserver}/r1/{serviceId}/v2/pets/5657082955040009<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: application/json<span class="pl-pds">"</span></span>  -H <span class="pl-s"><span class="pl-pds">"</span>X-Road-Client: {client}<span class="pl-pds">"</span></span> -d <span class="pl-s"><span class="pl-pds">'</span>{ "id": 0, "category": { "id": 0, "name": "string" }, "name": "doggie", "photoUrls": [ "string" ], "tags": [ { "id": 0, "name": "string" } ], "status": "available"}<span class="pl-pds">'</span></span></pre></div>
<p>Service response</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"id"</span>: <span class="pl-c1">5657082955040009</span>,
  <span class="pl-ent">"category"</span>: {
    <span class="pl-ent">"id"</span>: <span class="pl-c1">0</span>,
    <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
  },
  <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>doggie<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"photoUrls"</span>: [
    <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
  ],
  <span class="pl-ent">"tags"</span>: [
    {
      <span class="pl-ent">"id"</span>: <span class="pl-c1">0</span>,
      <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
    }
  ],
  <span class="pl-ent">"status"</span>: <span class="pl-s"><span class="pl-pds">"</span>available<span class="pl-pds">"</span></span>
}</pre></div>
<p>Service response code</p>
<pre><code>200
</code></pre>
<p>Service response headers</p>
<pre><code>Date: Thu, 21 Mar 2019 12:43:33 GMT
x-road-id: acdb2c7a-c705-41c2-b595-4cd62e78316e
x-road-client: DEV/COM/222/TESTCLIENT
x-road-service: DEV/COM/222/TESTSERVICE/petstore
x-road-request-id: f92591a3-6bf0-49b1-987b-0dd78c034cc3
x-road-request-hash: MOEfTqBjdqYiX3db9hxJ6JvHvCpYqfA6t0Uhdv6g2I29fMY8ld4CbN8tslj6mUQPXoRaUdPm7NdZeAYTg6zi+A==
Content-Length: 0
</code></pre>
<div class="markdown-heading"><h3 class="heading-element">6.4 POST Request and Response</h3><a id="64-post-request-and-response" class="anchor" aria-label="Permalink: 6.4 POST Request and Response" href="#64-post-request-and-response"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>REQUEST</p>
<table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Method</th>
<th align="left">Description</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/pets</td>
<td align="left">POST</td>
<td align="left">Add a new pet to the store</td>
<td align="left">body - Pet object that needs to be added to the store</td>
</tr>
</tbody>
</table>
<p>Service called directly</p>
<div class="highlight highlight-source-shell"><pre>curl -X POST <span class="pl-s"><span class="pl-pds">"</span>https://petstore.niis.org/v2/pets<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: application/json<span class="pl-pds">"</span></span> -d <span class="pl-s"><span class="pl-pds">'</span>{ "id": 0, "category": { "id": 0, "name": "string" }, "name": "doggie", "photoUrls": [ "string" ], "tags": [ { "id": 0, "name": "string" } ], "status": "available"}<span class="pl-pds">'</span></span></pre></div>
<p>Service called through X-Road</p>
<div class="highlight highlight-source-shell"><pre>curl -X POST <span class="pl-s"><span class="pl-pds">"</span>https://{securityserver}/r1/{serviceId}/v2/pets<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>X-Road-Client: {client}<span class="pl-pds">"</span></span> -d <span class="pl-s"><span class="pl-pds">'</span>{ "id": 0, "category": { "id": 0, "name": "string" }, "name": "doggie", "photoUrls": [ "string" ], "tags": [ { "id": 0, "name": "string" } ], "status": "available"}<span class="pl-pds">'</span></span></pre></div>
<p>Service response</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"id"</span>: <span class="pl-c1">5657082955040122</span>,
  <span class="pl-ent">"category"</span>: {
    <span class="pl-ent">"id"</span>: <span class="pl-c1">0</span>,
    <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
  },
  <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>doggie<span class="pl-pds">"</span></span>,
  <span class="pl-ent">"photoUrls"</span>: [
    <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
  ],
  <span class="pl-ent">"tags"</span>: [
    {
      <span class="pl-ent">"id"</span>: <span class="pl-c1">0</span>,
      <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>
    }
  ],
  <span class="pl-ent">"status"</span>: <span class="pl-s"><span class="pl-pds">"</span>available<span class="pl-pds">"</span></span>
}</pre></div>
<p>Service response code</p>
<pre><code>200
</code></pre>
<p>Service response headers</p>
<pre><code>Date: Thu, 21 Mar 2019 12:49:38 GMT
x-road-id: dcaaa3a2-a158-41e1-8775-309848052358
x-road-client: DEV/COM/222/TESTCLIENT
x-road-service: DEV/COM/222/TESTSERVICE/petstore
x-road-request-id: f92591a3-6bf0-49b1-987b-0dd78c034cc3
x-road-request-hash: VCNZdwTxl7m3XC6Mpfw1H6qJUtBcm3Y6tfCvg5b3W/fb2RRXsLF9wftR3u6ElclE+RFaiAN/OkSz02fAYbNKaw==
Content-Length: 0
</code></pre>
<div class="markdown-heading"><h3 class="heading-element">6.5 DELETE Request and Response</h3><a id="65-delete-request-and-response" class="anchor" aria-label="Permalink: 6.5 DELETE Request and Response" href="#65-delete-request-and-response"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>REQUEST</p>
<table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Method</th>
<th align="left">Description</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/pets/{petId}</td>
<td align="left">DELETE</td>
<td align="left">Deletes a pet</td>
<td align="left">petId - Pet id to delete</td>
</tr>
</tbody>
</table>
<p>Service called directly</p>
<div class="highlight highlight-source-shell"><pre>curl -X DELETE <span class="pl-s"><span class="pl-pds">"</span>https://petstore.niis.org/v2/pets/1124<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span></pre></div>
<p>Service called through X-Road</p>
<div class="highlight highlight-source-shell"><pre>curl -X DELETE <span class="pl-s"><span class="pl-pds">"</span>https://{securityserver}/r1/{serviceId}/v2/pets/1124<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span>  -H <span class="pl-s"><span class="pl-pds">"</span>X-Road-Client: {client}<span class="pl-pds">"</span></span></pre></div>
<p>Service response</p>
<pre><code></code></pre>
<p>Service response code</p>
<pre><code>200
</code></pre>
<p>Service response headers</p>
<pre><code>Date: Thu, 21 Mar 2019 12:49:38 GMT
x-road-id: 6209d61b-6ab5-4443-a09a-b8d2a7c491b2
x-road-client: DEV/COM/222/TESTCLIENT
x-road-service: DEV/COM/222/TESTSERVICE/petstore
x-road-request-id: f92591a3-6bf0-49b1-987b-0dd78c034cc3
x-road-request-hash: lQBoldcyuI3BerjHfkleRQ45AyYoFlF7zXSN6yH/RwvTNWEcsTQM18EfqMxYfdkyGGB26oxAjAWv/AcfmZF7og==
Content-Length: 0
</code></pre>
<div class="markdown-heading"><h3 class="heading-element">6.6 POST Request with Attachments and Response</h3><a id="66-post-request-with-attachments-and-response" class="anchor" aria-label="Permalink: 6.6 POST Request with Attachments and Response" href="#66-post-request-with-attachments-and-response"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>REQUEST</p>
<table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Method</th>
<th align="left">Description</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/pets/{petId}/images</td>
<td align="left">POST</td>
<td align="left">uploads an image</td>
<td align="left">• petId - ID of pet to update <br> • additionalMetadata - Additional data to pass to server <br> • file - file to upload</td>
</tr>
</tbody>
</table>
<p>Service called directly</p>
<div class="highlight highlight-source-shell"><pre>curl -X POST <span class="pl-s"><span class="pl-pds">"</span>https://petstore.niis.org/v2/pets/1124/images<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: multipart/form-data<span class="pl-pds">"</span></span> -F <span class="pl-s"><span class="pl-pds">"</span>file=@A-fluffy-cat-looking-funny-surprised-or-concerned.jpg;type=image/jpeg<span class="pl-pds">"</span></span></pre></div>
<p>Service called through X-Road</p>
<div class="highlight highlight-source-shell"><pre>curl -X POST <span class="pl-s"><span class="pl-pds">"</span>https://{securityserver}/r1/{serviceId}/v2/pets/1124/images<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>accept: application/json<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>Content-Type: multipart/form-data<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>X-Road-client: {client}<span class="pl-pds">"</span></span> -F <span class="pl-s"><span class="pl-pds">"</span>file=@A-fluffy-cat-looking-funny-surprised-or-concerned.jpg;type=image/jpeg<span class="pl-pds">"</span></span></pre></div>
<p>Service response</p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-ent">"code"</span>: <span class="pl-c1">200</span>,
  <span class="pl-ent">"type"</span>: <span class="pl-c1">null</span>,
  <span class="pl-ent">"message"</span>: <span class="pl-s"><span class="pl-pds">"</span>additionalMetadata: null<span class="pl-cce">\n</span>File uploaded to ./file, 170025 bytes<span class="pl-pds">"</span></span>
}</pre></div>
<p>Service response code</p>
<pre><code>200
</code></pre>
<p>Service response headers</p>
<pre><code>Content-Type: application/json;charset=utf-8
Date: Thu, 21 Mar 2019 13:02:29 GMT
x-road-id: 86e081a6-ec16-4b8d-b729-963f9659a80c
x-road-client: DEV/COM/222/TESTCLIENT
x-road-service: DEV/COM/222/TESTSERVICE/petstore
x-road-request-id: f92591a3-6bf0-49b1-987b-0dd78c034cc3
x-road-request-hash: EycIkZAz4WMvbKgnBvd0wUcN4A4w0RZMvugD36ZJ2PpwwGZuMGfxCoO4C0ZC3c4LBGF0rh61vunL3ssZV6TB3Q==
Content-Length: 100
</code></pre>
<div class="markdown-heading"><h2 class="heading-element">Appendix 1 Example Service Definition</h2><a id="appendix-1-example-service-definition" class="anchor" aria-label="Permalink: Appendix 1 Example Service Definition" href="#appendix-1-example-service-definition"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">openapi</span>: <span class="pl-s">3.0.0</span>
<span class="pl-ent">info</span>:
  <span class="pl-ent">description</span>: <span class="pl-s">&gt;-</span>
<span class="pl-s">    This is a sample server Petstore server.</span>
<span class="pl-s"></span>  <span class="pl-ent">version</span>: <span class="pl-s">1.0.0</span>
  <span class="pl-ent">title</span>: <span class="pl-s">Petstore</span>
  <span class="pl-ent">contact</span>:
    <span class="pl-ent">email</span>: <span class="pl-s">info@niis.org</span>
  <span class="pl-ent">license</span>:
    <span class="pl-ent">name</span>: <span class="pl-s">Apache 2.0</span>
    <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>http://www.apache.org/licenses/LICENSE-2.0.html<span class="pl-pds">'</span></span>
<span class="pl-ent">tags</span>:
  - <span class="pl-ent">name</span>: <span class="pl-s">pet</span>
    <span class="pl-ent">description</span>: <span class="pl-s">Everything about your Pets</span>
    <span class="pl-ent">externalDocs</span>:
      <span class="pl-ent">description</span>: <span class="pl-s">Find out more</span>
      <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>https://niis.org<span class="pl-pds">'</span></span>
  - <span class="pl-ent">name</span>: <span class="pl-s">store</span>
    <span class="pl-ent">description</span>: <span class="pl-s">Access to Petstore orders</span>
  - <span class="pl-ent">name</span>: <span class="pl-s">user</span>
    <span class="pl-ent">description</span>: <span class="pl-s">Operations about user</span>
    <span class="pl-ent">externalDocs</span>:
      <span class="pl-ent">description</span>: <span class="pl-s">Find out more about our store</span>
      <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>https://niis.org<span class="pl-pds">'</span></span>
<span class="pl-ent">paths</span>:
  <span class="pl-ent">/pets</span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Get pets from store</span>
      <span class="pl-ent">description</span>: <span class="pl-s">Search pets</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">getPets</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">term</span>
          <span class="pl-ent">in</span>: <span class="pl-s">query</span>
          <span class="pl-ent">description</span>: <span class="pl-s">search term</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">false</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">array</span>
                <span class="pl-ent">items</span>:
                  <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">array</span>
                <span class="pl-ent">items</span>:
                  <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet not found</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">api_key</span>: <span class="pl-s">[ ]</span>
    <span class="pl-ent">post</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Add a new pet to the store</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">addPet</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">201</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">pet created</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">405</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid input</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">petstore_auth</span>:
            - <span class="pl-s"><span class="pl-pds">'</span>write:pets<span class="pl-pds">'</span></span>
            - <span class="pl-s"><span class="pl-pds">'</span>read:pets<span class="pl-pds">'</span></span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/requestBodies/Pet<span class="pl-pds">'</span></span>
  <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">/pets/{petId}</span><span class="pl-pds">'</span></span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Find pet by ID</span>
      <span class="pl-ent">description</span>: <span class="pl-s">Returns a single pet</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">getPetById</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">petId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">ID of pet to return</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet not found</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">api_key</span>: <span class="pl-s">[ ]</span>
    <span class="pl-ent">put</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Update an existing pet</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">updatePet</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">petId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">ID of pet to return</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet updated</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet not found</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">405</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Validation exception</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">petstore_auth</span>:
            - <span class="pl-s"><span class="pl-pds">'</span>write:pets<span class="pl-pds">'</span></span>
            - <span class="pl-s"><span class="pl-pds">'</span>read:pets<span class="pl-pds">'</span></span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/requestBodies/Pet<span class="pl-pds">'</span></span>
    <span class="pl-ent">delete</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Deletes a pet</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">deletePet</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">api_key</span>
          <span class="pl-ent">in</span>: <span class="pl-s">header</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">false</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        - <span class="pl-ent">name</span>: <span class="pl-s">petId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">Pet id to delete</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet deleted</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Pet not found</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">petstore_auth</span>:
            - <span class="pl-s"><span class="pl-pds">'</span>write:pets<span class="pl-pds">'</span></span>
            - <span class="pl-s"><span class="pl-pds">'</span>read:pets<span class="pl-pds">'</span></span>
  <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">/pets/{petId}/images</span><span class="pl-pds">'</span></span>:
    <span class="pl-ent">post</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">pet</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Uploads an image</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">uploadFile</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">petId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">ID of pet to update</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/ApiResponse<span class="pl-pds">'</span></span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">petstore_auth</span>:
            - <span class="pl-s"><span class="pl-pds">'</span>write:pets<span class="pl-pds">'</span></span>
            - <span class="pl-s"><span class="pl-pds">'</span>read:pets<span class="pl-pds">'</span></span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">content</span>:
          <span class="pl-ent">multipart/form-data</span>:
            <span class="pl-ent">schema</span>:
              <span class="pl-ent">type</span>: <span class="pl-s">object</span>
              <span class="pl-ent">properties</span>:
                <span class="pl-ent">additionalMetadata</span>:
                  <span class="pl-ent">description</span>: <span class="pl-s">Additional data to pass to server</span>
                  <span class="pl-ent">type</span>: <span class="pl-s">string</span>
                <span class="pl-ent">file</span>:
                  <span class="pl-ent">description</span>: <span class="pl-s">file to upload</span>
                  <span class="pl-ent">type</span>: <span class="pl-s">string</span>
                  <span class="pl-ent">format</span>: <span class="pl-s">binary</span>
  <span class="pl-ent">/store/inventories</span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">store</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Returns pet inventories by status</span>
      <span class="pl-ent">description</span>: <span class="pl-s">Returns a map of status codes to quantities</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">getInventory</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">object</span>
                <span class="pl-ent">additionalProperties</span>:
                  <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
                  <span class="pl-ent">format</span>: <span class="pl-s">int32</span>
      <span class="pl-ent">security</span>:
        - <span class="pl-ent">api_key</span>: <span class="pl-s">[ ]</span>
  <span class="pl-ent">/store/orders</span>:
    <span class="pl-ent">post</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">store</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Place an order for a pet</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">placeOrder</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Order<span class="pl-pds">'</span></span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Order<span class="pl-pds">'</span></span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid Order</span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">content</span>:
          <span class="pl-ent">application/json</span>:
            <span class="pl-ent">schema</span>:
              <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Order<span class="pl-pds">'</span></span>
        <span class="pl-ent">description</span>: <span class="pl-s">order placed for purchasing the pet</span>
        <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
  <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">/store/orders/{orderId}</span><span class="pl-pds">'</span></span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">store</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Find purchase order by ID</span>
      <span class="pl-ent">description</span>: <span class="pl-s">&gt;-</span>
<span class="pl-s">        For valid response try integer IDs with value &gt;= 1 and &lt;= 10.      </span>
<span class="pl-s">        Other values will generated exceptions</span>
<span class="pl-s"></span>      <span class="pl-ent">operationId</span>: <span class="pl-s">getOrderById</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">orderId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">ID of pet that needs to be fetched</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
            <span class="pl-ent">minimum</span>: <span class="pl-c1">1</span>
            <span class="pl-ent">maximum</span>: <span class="pl-c1">10</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Order<span class="pl-pds">'</span></span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Order<span class="pl-pds">'</span></span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Order not found</span>
    <span class="pl-ent">delete</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">store</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Delete purchase order by ID</span>
      <span class="pl-ent">description</span>: <span class="pl-s">&gt;-</span>
<span class="pl-s">        For valid response try integer IDs with positive integer value.      </span>
<span class="pl-s">        Negative or non-integer values will generate API errors</span>
<span class="pl-s"></span>      <span class="pl-ent">operationId</span>: <span class="pl-s">deleteOrder</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">orderId</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">ID of the order that needs to be deleted</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
            <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
            <span class="pl-ent">minimum</span>: <span class="pl-c1">1</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Purchase order deleted</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid ID supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Order not found</span>
  <span class="pl-ent">/users</span>:
    <span class="pl-ent">post</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Create user</span>
      <span class="pl-ent">description</span>: <span class="pl-s">This can only be done by the logged in user.</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">createUser</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-ent">default</span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">content</span>:
          <span class="pl-ent">application/json</span>:
            <span class="pl-ent">schema</span>:
              <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/User<span class="pl-pds">'</span></span>
        <span class="pl-ent">description</span>: <span class="pl-s">Created user object</span>
        <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
  <span class="pl-ent">/users/login</span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Logs user into the system</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">loginUser</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">username</span>
          <span class="pl-ent">in</span>: <span class="pl-s">query</span>
          <span class="pl-ent">description</span>: <span class="pl-s">The user name for login</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        - <span class="pl-ent">name</span>: <span class="pl-s">password</span>
          <span class="pl-ent">in</span>: <span class="pl-s">query</span>
          <span class="pl-ent">description</span>: <span class="pl-s">The password for login in clear text</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">headers</span>:
            <span class="pl-ent">X-Rate-Limit</span>:
              <span class="pl-ent">description</span>: <span class="pl-s">calls per hour allowed by the user</span>
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
                <span class="pl-ent">format</span>: <span class="pl-s">int32</span>
            <span class="pl-ent">X-Expires-After</span>:
              <span class="pl-ent">description</span>: <span class="pl-s">date in UTC when token expires</span>
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">string</span>
                <span class="pl-ent">format</span>: <span class="pl-s">date-time</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">string</span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid username/password supplied</span>
  <span class="pl-ent">/users/logout</span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Logs out current logged in user session</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">logoutUser</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-ent">default</span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
  <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">/users/{username}</span><span class="pl-pds">'</span></span>:
    <span class="pl-ent">get</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Get user by user name</span>
      <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">getUserByName</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">username</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s"><span class="pl-pds">'</span>The name that needs to be fetched. Use user1 for testing. <span class="pl-pds">'</span></span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">successful operation</span>
          <span class="pl-ent">content</span>:
            <span class="pl-ent">application/xml</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/User<span class="pl-pds">'</span></span>
            <span class="pl-ent">application/json</span>:
              <span class="pl-ent">schema</span>:
                <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/User<span class="pl-pds">'</span></span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid username supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">User not found</span>
    <span class="pl-ent">put</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Updated user</span>
      <span class="pl-ent">description</span>: <span class="pl-s">This can only be done by the logged in user.</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">updateUser</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">username</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">name that need to be updated</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">User updated</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid user supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">User not found</span>
      <span class="pl-ent">requestBody</span>:
        <span class="pl-ent">content</span>:
          <span class="pl-ent">application/json</span>:
            <span class="pl-ent">schema</span>:
              <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/User<span class="pl-pds">'</span></span>
        <span class="pl-ent">description</span>: <span class="pl-s">Updated user object</span>
        <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
    <span class="pl-ent">delete</span>:
      <span class="pl-ent">tags</span>:
        - <span class="pl-s">user</span>
      <span class="pl-ent">summary</span>: <span class="pl-s">Delete user</span>
      <span class="pl-ent">description</span>: <span class="pl-s">This can only be done by the logged in user.</span>
      <span class="pl-ent">operationId</span>: <span class="pl-s">deleteUser</span>
      <span class="pl-ent">parameters</span>:
        - <span class="pl-ent">name</span>: <span class="pl-s">username</span>
          <span class="pl-ent">in</span>: <span class="pl-s">path</span>
          <span class="pl-ent">description</span>: <span class="pl-s">The name that needs to be deleted</span>
          <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">responses</span>:
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">200</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">User deleted</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">400</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">Invalid username supplied</span>
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">404</span><span class="pl-pds">'</span></span>:
          <span class="pl-ent">description</span>: <span class="pl-s">User not found</span>
<span class="pl-ent">externalDocs</span>:
  <span class="pl-ent">description</span>: <span class="pl-s">Find out more</span>
  <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>https://niis.org<span class="pl-pds">'</span></span>
<span class="pl-ent">servers</span>:
  - <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>https://petstore.niis.org/v2<span class="pl-pds">'</span></span>
  - <span class="pl-ent">url</span>: <span class="pl-s"><span class="pl-pds">'</span>http://petstore.niis.org/v2<span class="pl-pds">'</span></span>
<span class="pl-ent">components</span>:
  <span class="pl-ent">requestBodies</span>:
    <span class="pl-ent">UserArray</span>:
      <span class="pl-ent">content</span>:
        <span class="pl-ent">application/json</span>:
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">array</span>
            <span class="pl-ent">items</span>:
              <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/User<span class="pl-pds">'</span></span>
      <span class="pl-ent">description</span>: <span class="pl-s">List of user object</span>
      <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
    <span class="pl-ent">Pet</span>:
      <span class="pl-ent">content</span>:
        <span class="pl-ent">application/json</span>:
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
        <span class="pl-ent">application/xml</span>:
          <span class="pl-ent">schema</span>:
            <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Pet<span class="pl-pds">'</span></span>
      <span class="pl-ent">description</span>: <span class="pl-s">Pet object that needs to be added to the store</span>
      <span class="pl-ent">required</span>: <span class="pl-c1">true</span>
  <span class="pl-ent">securitySchemes</span>:
    <span class="pl-ent">petstore_auth</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">oauth2</span>
      <span class="pl-ent">flows</span>:
        <span class="pl-ent">implicit</span>:
          <span class="pl-ent">authorizationUrl</span>: <span class="pl-s"><span class="pl-pds">'</span>http://petstore.niis.org/oauth/dialog<span class="pl-pds">'</span></span>
          <span class="pl-ent">scopes</span>:
            <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">write:pets</span><span class="pl-pds">'</span></span>: <span class="pl-s">modify pets in your account</span>
            <span class="pl-s"><span class="pl-pds">'</span><span class="pl-ent">read:pets</span><span class="pl-pds">'</span></span>: <span class="pl-s">read your pets</span>
    <span class="pl-ent">api_key</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">apiKey</span>
      <span class="pl-ent">name</span>: <span class="pl-s">api_key</span>
      <span class="pl-ent">in</span>: <span class="pl-s">header</span>
  <span class="pl-ent">schemas</span>:
    <span class="pl-ent">Order</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">id</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">petId</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">quantity</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int32</span>
        <span class="pl-ent">shipDate</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
          <span class="pl-ent">format</span>: <span class="pl-s">date-time</span>
        <span class="pl-ent">status</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
          <span class="pl-ent">description</span>: <span class="pl-s">Order Status</span>
          <span class="pl-ent">enum</span>:
            - <span class="pl-s">placed</span>
            - <span class="pl-s">approved</span>
            - <span class="pl-s">delivered</span>
        <span class="pl-ent">complete</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">boolean</span>
          <span class="pl-ent">default</span>: <span class="pl-c1">false</span>
      <span class="pl-ent">xml</span>:
        <span class="pl-ent">name</span>: <span class="pl-s">Order</span>
    <span class="pl-ent">Category</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">id</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">name</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">xml</span>:
        <span class="pl-ent">name</span>: <span class="pl-s">Category</span>
    <span class="pl-ent">User</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">id</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">username</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">firstName</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">lastName</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">email</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">password</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">phone</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">userStatus</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int32</span>
          <span class="pl-ent">description</span>: <span class="pl-s">User Status</span>
      <span class="pl-ent">xml</span>:
        <span class="pl-ent">name</span>: <span class="pl-s">User</span>
    <span class="pl-ent">Tag</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">id</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">name</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
      <span class="pl-ent">xml</span>:
        <span class="pl-ent">name</span>: <span class="pl-s">Tag</span>
    <span class="pl-ent">Pet</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">required</span>:
        - <span class="pl-s">name</span>
        - <span class="pl-s">photoUrls</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">id</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int64</span>
        <span class="pl-ent">category</span>:
          <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Category<span class="pl-pds">'</span></span>
        <span class="pl-ent">name</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
          <span class="pl-ent">example</span>: <span class="pl-s">doggie</span>
        <span class="pl-ent">photoUrls</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">array</span>
          <span class="pl-ent">xml</span>:
            <span class="pl-ent">name</span>: <span class="pl-s">photoUrl</span>
            <span class="pl-ent">wrapped</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">items</span>:
            <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">tags</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">array</span>
          <span class="pl-ent">xml</span>:
            <span class="pl-ent">name</span>: <span class="pl-s">tag</span>
            <span class="pl-ent">wrapped</span>: <span class="pl-c1">true</span>
          <span class="pl-ent">items</span>:
            <span class="pl-ent">$ref</span>: <span class="pl-s"><span class="pl-pds">'</span>#/components/schemas/Tag<span class="pl-pds">'</span></span>
        <span class="pl-ent">status</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
          <span class="pl-ent">description</span>: <span class="pl-s">pet status in the store</span>
          <span class="pl-ent">enum</span>:
            - <span class="pl-s">available</span>
            - <span class="pl-s">pending</span>
            - <span class="pl-s">sold</span>
      <span class="pl-ent">xml</span>:
        <span class="pl-ent">name</span>: <span class="pl-s">Pet</span>
    <span class="pl-ent">ApiResponse</span>:
      <span class="pl-ent">type</span>: <span class="pl-s">object</span>
      <span class="pl-ent">properties</span>:
        <span class="pl-ent">code</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">integer</span>
          <span class="pl-ent">format</span>: <span class="pl-s">int32</span>
        <span class="pl-ent">type</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span>
        <span class="pl-ent">message</span>:
          <span class="pl-ent">type</span>: <span class="pl-s">string</span></pre></div>
    </article>
  </body>
</html>
